<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STool: stool::bwt::LFDataStructure Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STool
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classstool_1_1bwt_1_1LFDataStructure.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classstool_1_1bwt_1_1LFDataStructure-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">stool::bwt::LFDataStructure Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI's Comment].  
 <a href="classstool_1_1bwt_1_1LFDataStructure.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lf__data__structure_8hpp_source.html">lf_data_structure.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9c6e021fef5d3d8f064193a5357d6ba4" id="r_a9c6e021fef5d3d8f064193a5357d6ba4"><td class="memItemLeft" align="right" valign="top"><a id="a9c6e021fef5d3d8f064193a5357d6ba4" name="a9c6e021fef5d3d8f064193a5357d6ba4"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>INDEX</b> = uint64_t</td></tr>
<tr class="memdesc:a9c6e021fef5d3d8f064193a5357d6ba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index type used throughout the class. <br /></td></tr>
<tr class="separator:a9c6e021fef5d3d8f064193a5357d6ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a79651888f8f4e08b2e450e3c344a56aa" id="r_a79651888f8f4e08b2e450e3c344a56aa"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html#a79651888f8f4e08b2e450e3c344a56aa">lf</a> (uint64_t i) const</td></tr>
<tr class="memdesc:a79651888f8f4e08b2e450e3c344a56aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs LF mapping operation.  <br /></td></tr>
<tr class="separator:a79651888f8f4e08b2e450e3c344a56aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9598d64df7f210b58a2ad7860e4dde" id="r_abc9598d64df7f210b58a2ad7860e4dde"><td class="memItemLeft" align="right" valign="top">std::vector&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html#abc9598d64df7f210b58a2ad7860e4dde">construct_suffix_array</a> ()</td></tr>
<tr class="memdesc:abc9598d64df7f210b58a2ad7860e4dde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs the suffix array from the BWT.  <br /></td></tr>
<tr class="separator:abc9598d64df7f210b58a2ad7860e4dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f672b256f05545df7858aac25f98a81" id="r_a6f672b256f05545df7858aac25f98a81"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html#a6f672b256f05545df7858aac25f98a81">get_end_marker_position</a> () const</td></tr>
<tr class="memdesc:a6f672b256f05545df7858aac25f98a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the position of the end marker in the BWT.  <br /></td></tr>
<tr class="separator:a6f672b256f05545df7858aac25f98a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae85e744c626e4333cc1fb0ba095199d" id="r_aae85e744c626e4333cc1fb0ba095199d"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html#aae85e744c626e4333cc1fb0ba095199d">get_text_size</a> () const</td></tr>
<tr class="memdesc:aae85e744c626e4333cc1fb0ba095199d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the original text.  <br /></td></tr>
<tr class="separator:aae85e744c626e4333cc1fb0ba095199d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a929dd6c372ee1a33baa095390d3a070e" id="r_a929dd6c372ee1a33baa095390d3a070e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html">LFDataStructure</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html#a929dd6c372ee1a33baa095390d3a070e">build</a> (const std::vector&lt; uint8_t &gt; &amp;bwt, int message_paragraph=<a class="el" href="classstool_1_1Message.html#a376bd81e35f76588b563b6fc74f82714">stool::Message::SHOW_MESSAGE</a>)</td></tr>
<tr class="memdesc:a929dd6c372ee1a33baa095390d3a070e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html" title="LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI&#39;s Comment].">LFDataStructure</a> from a BWT vector.  <br /></td></tr>
<tr class="separator:a929dd6c372ee1a33baa095390d3a070e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI's Comment]. </p>
<p>This class provides efficient LF mapping operations on the Burrows-Wheeler Transform (BWT) of a text. The LF mapping is a fundamental operation that allows navigation through the BWT and enables various string processing algorithms.</p>
<p>The data structure consists of:</p><ul>
<li>The BWT itself as an integer vector</li>
<li>A C array for character counting</li>
<li>A wavelet tree (GMR variant) for efficient rank operations</li>
<li>End marker information for BWT navigation </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a929dd6c372ee1a33baa095390d3a070e" name="a929dd6c372ee1a33baa095390d3a070e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a929dd6c372ee1a33baa095390d3a070e">&#9670;&#160;</a></span>build()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html">LFDataStructure</a> stool::bwt::LFDataStructure::build </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>bwt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>message_paragraph</em> = <code><a class="el" href="classstool_1_1Message.html#a376bd81e35f76588b563b6fc74f82714">stool::Message::SHOW_MESSAGE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds an <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html" title="LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI&#39;s Comment].">LFDataStructure</a> from a BWT vector. </p>
<p>This static factory method constructs a complete <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html" title="LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI&#39;s Comment].">LFDataStructure</a> from a BWT. It performs all necessary preprocessing including:</p><ul>
<li>Converting the BWT to an integer vector</li>
<li>Computing character frequencies and the C array</li>
<li>Finding the end marker and its position</li>
<li>Constructing the wavelet tree for efficient operations</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bwt</td><td>The Burrows-Wheeler Transform as a vector of bytes </td></tr>
    <tr><td class="paramname">message_paragraph</td><td><a class="el" href="classstool_1_1Message.html" title="Message utility class for computing the paragraph level of log messages.">Message</a> level for progress reporting </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A fully constructed <a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html" title="LF (Last-First) mapping data structure for Burrows-Wheeler Transform [Unchecked AI&#39;s Comment].">LFDataStructure</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstool_1_1bwt_1_1LFDataStructure_a929dd6c372ee1a33baa095390d3a070e_cgraph.png" border="0" usemap="#aclassstool_1_1bwt_1_1LFDataStructure_a929dd6c372ee1a33baa095390d3a070e_cgraph" alt=""/></div>
<map name="aclassstool_1_1bwt_1_1LFDataStructure_a929dd6c372ee1a33baa095390d3a070e_cgraph" id="aclassstool_1_1bwt_1_1LFDataStructure_a929dd6c372ee1a33baa095390d3a070e_cgraph">
<area shape="rect" title="Builds an LFDataStructure from a BWT vector." alt="" coords="5,37,204,77"/>
<area shape="rect" href="classstool_1_1Message.html#a4ce82615b8f27a0c37991c04fdd58de3" title="Generates indentation string based on paragraph level (e.g., get_paragraph_string(1) returns &quot; &#160;&quot;)" alt="" coords="275,5,424,45"/>
<area shape="poly" title=" " alt="" coords="204,42,261,34,261,39,204,47"/>
<area shape="rect" href="classstool_1_1Message.html#a70c518c8e93e1b494756891d4ddec02a" title="Increments the message paragraph level if the given paragraph level is non&#45;negative." alt="" coords="252,69,447,109"/>
<area shape="poly" title=" " alt="" coords="204,68,239,72,238,77,204,73"/>
</map>
</div>

</div>
</div>
<a id="abc9598d64df7f210b58a2ad7860e4dde" name="abc9598d64df7f210b58a2ad7860e4dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc9598d64df7f210b58a2ad7860e4dde">&#9670;&#160;</a></span>construct_suffix_array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; uint64_t &gt; stool::bwt::LFDataStructure::construct_suffix_array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs the suffix array from the BWT. </p>
<p>This function reconstructs the suffix array using the LF mapping. It starts from the end marker position and iteratively applies LF to traverse the BWT and build the complete suffix array.</p>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the suffix array </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstool_1_1bwt_1_1LFDataStructure_abc9598d64df7f210b58a2ad7860e4dde_cgraph.png" border="0" usemap="#aclassstool_1_1bwt_1_1LFDataStructure_abc9598d64df7f210b58a2ad7860e4dde_cgraph" alt=""/></div>
<map name="aclassstool_1_1bwt_1_1LFDataStructure_abc9598d64df7f210b58a2ad7860e4dde_cgraph" id="aclassstool_1_1bwt_1_1LFDataStructure_abc9598d64df7f210b58a2ad7860e4dde_cgraph">
<area shape="rect" title="Constructs the suffix array from the BWT." alt="" coords="5,5,204,45"/>
<area shape="rect" href="classstool_1_1bwt_1_1BWTFunctions.html#aed17c6b193a04c89c826c15ba1d8ba6f" title="Computes the LF (Last&#45;to&#45;First) mapping for a given position." alt="" coords="252,13,461,38"/>
<area shape="poly" title=" " alt="" coords="204,23,238,23,238,28,204,28"/>
</map>
</div>

</div>
</div>
<a id="a6f672b256f05545df7858aac25f98a81" name="a6f672b256f05545df7858aac25f98a81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f672b256f05545df7858aac25f98a81">&#9670;&#160;</a></span>get_end_marker_position()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stool::bwt::LFDataStructure::get_end_marker_position </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the position of the end marker in the BWT. </p>
<dl class="section return"><dt>Returns</dt><dd>The position of the end marker </dd></dl>

</div>
</div>
<a id="aae85e744c626e4333cc1fb0ba095199d" name="aae85e744c626e4333cc1fb0ba095199d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae85e744c626e4333cc1fb0ba095199d">&#9670;&#160;</a></span>get_text_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stool::bwt::LFDataStructure::get_text_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the size of the original text. </p>
<dl class="section return"><dt>Returns</dt><dd>The size of the text (equal to BWT size) </dd></dl>

</div>
</div>
<a id="a79651888f8f4e08b2e450e3c344a56aa" name="a79651888f8f4e08b2e450e3c344a56aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79651888f8f4e08b2e450e3c344a56aa">&#9670;&#160;</a></span>lf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stool::bwt::LFDataStructure::lf </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs LF mapping operation. </p>
<p>The LF mapping is defined as LF(i) = C[c] + rank(i, c) where c = BWT[i]. This operation is fundamental for navigating through the BWT and is used in various string processing algorithms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>The position in the BWT </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The LF-mapped position </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/bwt/<a class="el" href="lf__data__structure_8hpp_source.html">lf_data_structure.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>stool</b></li><li class="navelem"><b>bwt</b></li><li class="navelem"><a class="el" href="classstool_1_1bwt_1_1LFDataStructure.html">LFDataStructure</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
